datasource db {
  provider = "postgresql"
  url      = env("POSTGRES_URL")
}

generator client {
  provider = "prisma-client-js"
}

model Campaign {
  uri           String    @id
  title         String
  description   String
  creator       User      @relation(fields: [creatorId], references: [id])
  creatorId     Int    
  guardian      String
  oracle        String
  execDate      DateTime
  cancelDate    DateTime
  stratID       String
  stratParams   String    // For now, Params are stringified as they can have any structure
  rewards       Reward[] 
}

enum CampaignState {
  PendingExecution
  PendingIdentityValidation
  MerkleRootSet
}

model User {
  id            Int       @id @default(autoincrement())
  address       String    @unique
  rewards       Reward[]
  created       Campaign[]
}

model Reward {
  id            Int       @id @default(autoincrement())
  user          User      @relation(fields: [userId], references: [id])
  userId        Int
  campaign      Campaign  @relation(fields: [campaignId], references: [uri])
  campaignId    String
}
